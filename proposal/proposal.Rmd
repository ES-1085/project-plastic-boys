---
title: "Project proposal"
author: "THE Triangle"
output: html_document
---

```{r load-packages, message = FALSE}
library(tidyverse)
library(readxl)
library(janitor)
library(broom)
library(ggridges)
library(leaflet)
library(htmltools)
library(sf)
```

## 1. Introduction
Microplastics have become more and more well known throughout the world in the past few years. We now recognize that they are an incredibly dangerous bi-product to marine life and many organizations have begun to attack the problem. That is what this project is about

## 2. Data
Our project will be looking at a 2023 dataset by Leslie Hart of microplastic samples in prey fish caught in Sarasota Bay. The samples were extracted from muscle tissue and GI tracts of the fish, and sorted by size, type, color, and quantity.
```{r import-and-clean-data, message=FALSE}
fish_microplastics <- read_xlsx("../data/Fish_Microplastics_Data_Repository.xlsx", 
                                na = "NA") %>%
  janitor::clean_names() 

fish_microplastics <- fish_microplastics %>%
  mutate(sieve_size = str_extract(sieve_size, pattern = "[:digit:]+")) %>%
  mutate(sieve_size = case_when(sieve_size == "LG" ~ 777,
          TRUE ~ as.numeric(sieve_size))) %>%
  mutate(hot_needle = case_when(hot_needle == "yes" ~ TRUE, hot_needle == "no" ~ FALSE))
```
```{r glimpse}
glimpse(fish_microplastics)
```
## 3. Ethics review
We did not collect this data so there was no ethical issue of us cutting up the fish. 

## 4. Data analysis plan
With the data we plan on primarily making spatial plots with Leaflet. We want to see where these fish were gathered and if there is any correlation with the. We also want to see if there is a correlation between different fish and the average count of micro plastics found within it. It would be interesting to see if multiple variables like the distinct IDs and the average count have any correlation.

```{r prelim-plot-gi-bar}
fish_microplastics %>%
  group_by(fish_id) %>%
  ggplot(aes(x = fish_id, fill = sample_type)) +
  geom_bar() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
```
```{r prelim-plot-quant-density}
fish_microplastics %>%
  group_by(fish_id) %>%
  ggplot(aes(x = quantity, y = fish_id, fill = fish_id)) +
  geom_density_ridges()
```
```{r prelim-leaflet}
leaflet(data = fish_microplastics) %>%
  addProviderTiles(providers$Esri.OceanBasemap) %>%
  setView(lng = -82.5,
          lat = 27.4,
          zoom = 10)
```
