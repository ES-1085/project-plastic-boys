---
title: "Fish Microplastics Analysis"
author: "Mabon Young, John Calzini, and Gordon Maguire"
date: "2/7/2024"
output: github_document
---

## Load packages and data

```{r load-packages, message=FALSE}
# install.packages("tidyverse")
# install.packages("readxl")
# install.packages("janitor")

library(tidyverse)
library(readxl)
library(janitor)
```

```{r load-dataset}
fish_microplastics <- read_xlsx("data/Fish_Microplastics_Data_Repository.xlsx", 
                                na = "NA") %>%
  janitor::clean_names() 

glimpse(fish_microplastics) 

#Sieve size is still a character, some of the entries have um after them, will need to figure out how to fix that later. Could also convert hot needle into a logical vector.
```

```{r fixdacolumns}
fish_microplastics <- fish_microplastics %>%
  mutate(sieve_size_clean = str_extract(sieve_size, pattern = "[:digit:]+")) %>%
  relocate(sieve_size_clean, .after = sieve_size) %>%
  mutate(sieve_size_clean = case_when(sieve_size == "LG" ~ 777,
          TRUE ~ as.numeric(sieve_size_clean)))
  

```


```{r}
ggplot(data = fish_microplastics, mapping = aes(x = net_sample_mass_g)) +
  geom_histogram(binwidth = 1000) +
  facet_wrap(~color)
```

```{r}
fish_microplastics %>%
  group_by(color) %>%
  summarize(
    avg_ht = mean(quantity, na.rm = TRUE)
    ) %>% 
  arrange(desc(avg_ht)) %>% 
slice(1:5) 
```
```{r}
fish_microplastics %>% 
group_by(color) %>%
  summarize(
    avg_ht = mean(quantity, na.rm = TRUE), median = median(quantity, na.rm = TRUE), min = min(quantity, na.rm = TRUE), max = max(quantity, na.rm = TRUE), sd = sd(quantity, na.rm = TRUE), IQR = IQR(quantity, na.rm = TRUE)
    )
```
```{r}

```



